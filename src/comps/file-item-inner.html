<template component>
  <style>
    :host {
      display: block;
      user-select: none;
      --space-left: var(--sub-space-left, 6px);
    }
    .container {
      position: relative;
      display: flex;
      align-items: center;
      padding-left: var(--space-left);
      font-size: 15px;
      height: var(--item-height, 30px);
      opacity: var(--item-opacity, 1);
      font-weight: 500;
      transition: all ease 0.2s;
      overflow: hidden;
    }

    /* @container style(--hide-item:1) {
      .container {
        height: 0;
        opacity:0;
      }
    } */

    .container > * {
      z-index: 1;
      position: relative;
    }

    .bg-con {
      z-index: 0;
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
    }

    .container:hover .bg-con {
      background-color: rgba(255, 255, 255, 0.07);
    }

    :host([selected]) .bg-con {
      box-sizing: border-box;
      background-color: rgba(0, 102, 255, 0.3);
      border: rgba(0, 102, 255, 1) solid 1px;
    }

    .icon-con {
      display: flex;
      align-items: center;
      width: 22px;
    }

    .childs {
      --sub-space-left: calc(var(--space-left) + 12px);
    }

    :host iconify-icon {
      transition: all ease 0.2s;
    }

    :host([folder="open"]) iconify-icon {
      transform: rotate(90deg);
    }
    :host([folder="close"]) iconify-icon {
      transform: rotate(0deg);
    }
  </style>
  <div class="container" part="container">
    <div class="bg-con" part="bg"></div>
    <div class="icon-con">
      <iconify-icon
        attr:icon="iconname"
        :css.font-size="size"
        :css.color="iconcolor"
      ></iconify-icon>
    </div>
    <div>{{name}}</div>
  </div>
  <div class="childs">
    <slot></slot>
  </div>
  <script>
    export default {
      tag: "ocode-file-item-inner",
      attrs: {
        folder: null,
        name: "",
      },
      data: {
        suffix: "",
        iconname: null,
        size: "18px",
        iconcolor: null,
      },
      watch: {
        name(name) {
          if (!name) {
            return;
          }

          if (this.folder !== null) {
            this.iconname = "mingcute:right-fill";
            return;
          }

          const pArr = this.name.split(".");
          if (pArr.length === 1) {
            if (this.name === "LICENSE") {
              this.iconname = "mdi:license";
              this.iconcolor = "#cdca4c";
              return;
            }
            this.iconname = "mdi:file-outline";
            return;
          }

          const suffix = pArr[pArr.length - 1];

          let iconname = "mdi:file-outline";
          let size = "18px";
          let iconcolor = null;

          switch (suffix) {
            case "html":
              iconname = "material-symbols:code";
              iconcolor = "#fb4747";
              break;
            case "js":
            case "mjs":
            case "cjs":
              iconname = "fluent:code-js-16-filled";
              iconcolor = "#cdca4c";
              break;
            case "css":
              iconname = "ph:hash-bold";
              iconcolor = "#0c86e0";
              size = "15px";
              break;
            case "json":
              iconname = "ph:brackets-curly-bold";
              size = "16px";
              iconcolor = "#b4b247";
              break;
            case "md":
              iconname = "material-symbols:markdown";
              iconcolor = "#4e9bb9";
              break;
            case "jpg":
            case "jpeg":
            case "png":
            case "svg":
            case "bmp":
            case "webp":
              iconname = "material-symbols:image-outline";
              iconcolor = "#9f76c2";
              break;
            case "gif":
              iconname = "mage:gif";
              break;
            case "mp4":
            case "webm":
              iconname = "mdi:video-outline";
            default:
              iconname = "mdi:file-outline";
          }

          this.size = size;
          this.iconname = iconname;
          this.iconcolor = iconcolor;
        },
      },
    };
  </script>
</template>
